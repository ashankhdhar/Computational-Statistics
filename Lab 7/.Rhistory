cat.stats(cats$Bwt)
cat.stats <- function(vec)
{
m<-sum(vec)/length(vec)
var <- sum(((vec-m)^2))/(length(vec)-1)
return(c("Mean"=mean,"Variance"=var))
}
cat.stats(cats$Bwt)
summary(cats)
var(cats$Bwt)
cat.stats <- function(vec)
{
m<-sum(vec)/length(vec)
var <- sum(((vec-m)^2))/(length(vec)-1)
return(c("Mean"=m,"Variance"=var))
}
cat.stats(cats$Bwt)
if(cats$Sex="M"){
cat("The body weight parameters are:",cat.stats(cats$Bwt))
cat("The heart weight paramters are:", cat.stats(cats$Hwt))
}
if(cats$Sex="M"){
cat("The body weight parameters for male cats are:",cat.stats(cats$Bwt))
cat("The heart weight paramters for male cats are:", cat.stats(cats$Hwt))
}else{
cat("The body weight parameters for female cats are:",cat.stats(cats$Bwt))
cat("The heart weight paramters for female cats are:", cat.stats(cats$Hwt))
}
if(cats$Sex=="M"){
cat("The body weight parameters for male cats are:",cat.stats(cats$Bwt))
cat("The heart weight paramters for male cats are:", cat.stats(cats$Hwt))
}else{
cat("The body weight parameters for female cats are:",cat.stats(cats$Bwt))
cat("The heart weight paramters for female cats are:", cat.stats(cats$Hwt))
}
cats$Sex="M"
is(cats$Sex="M")
cats$Sex="M"
cats$Sex[M]
cats$Sex["M"]
if(cats$Sex==M){
cat("The body weight parameters for male cats are:",cat.stats(cats$Bwt))
cat("The heart weight paramters for male cats are:", cat.stats(cats$Hwt))
}else{
cat("The body weight parameters for female cats are:",cat.stats(cats$Bwt))
cat("The heart weight paramters for female cats are:", cat.stats(cats$Hwt))
}
if(cats$Sex=="M"){
cat("The body weight parameters for male cats are:",cat.stats(cats$Bwt))
cat("The heart weight paramters for male cats are:", cat.stats(cats$Hwt))
}else{
cat("The body weight parameters for female cats are:",cat.stats(cats$Bwt))
cat("The heart weight paramters for female cats are:", cat.stats(cats$Hwt))
}
cats$Sex
cats$Sex
cats$Sex=="F"
View(cats)
library(MASS)
data(cats)
summary(cats)
View(cats)
cats$Sex
if(cats$Sex=="M"){
cat("The body weight parameters for male cats are:",cat.stats(cats$Bwt))
cat("The heart weight paramters for male cats are:", cat.stats(cats$Hwt))
}else{
cat("The body weight parameters for female cats are:",cat.stats(cats$Bwt))
cat("The heart weight paramters for female cats are:", cat.stats(cats$Hwt))
}
View(cats)
for (i in cats$Sex){
if(cats$Sex[i]=="M"){
cat("The body weight parameters for male cats are:",cat.stats(cats$Bwt))
cat("The heart weight paramters for male cats are:", cat.stats(cats$Hwt))
}else{
cat("The body weight parameters for female cats are:",cat.stats(cats$Bwt))
cat("The heart weight paramters for female cats are:", cat.stats(cats$Hw))
}
}
males<-where[cats$Sex=="M"]
males<-which[cats$Sex=="M"]
View(cats)
cats$Sex
cats$Sex==
"M"
for (i in cats$Sex){
if(cats$Sex[i]=="M"){
cat("The body weight parameters for male cats are:",cat.stats(cats$Bwt))
cat("The heart weight paramters for male cats are:", cat.stats(cats$Hwt))
}else{
cat("The body weight parameters for female cats are:",cat.stats(cats$Bwt))
cat("The heart weight paramters for female cats are:", cat.stats(cats$Hw))
}
}
males<-which(cats$Sex=="M")
males
males<-which(cats$Sex=="M")
cat("The body weight parameters for male cats are:",cat.stats(cats$Bwt[males]))
cat("The heart weight paramters for male cats are:", cat.stats(cats$Hwt[males]))
females<which(cats$Sex=="F")
cat("The body weight parameters for female cats are:",cat.stats(cats$Bwt[females]))
cat("The heart weight paramters for female cats are:", cat.stats(cats$Hw[females]))
females<which(cats$Sex=="F")
females<-which(cats$Sex=="F")
cat("The body weight parameters for female cats are:",cat.stats(cats$Bwt[females]))
cat("The heart weight paramters for female cats are:", cat.stats(cats$Hw[females]))
```
hist(cats$Bwt[females])
curve(dgamma())
curve(dgamma(cats$Bwt[females]))
hist(cats$Bwt[females])
curve(digamma(cats$Bwt[females]))
dgamma(cats$Bwt[females])
cat("The body weight parameters for female cats are:",cat.stats(cats$Bwt[females]))
cat.stats(cats$Bwt[females]))
cat.stats(cats$Bwt[females])
cat.stats <- function(vec)
{
m<-sum(vec)/length(vec)
var <- sum(((vec-m)^2))/(length(vec)-1)
a<-(m^2)/var
s<-var/m
return(c("Mean"=m,"Variance"=var,"a"=a,"s"=s))
}
cat.stats(cats$Bwt[females])
cat.stats(cats$Bwt[females])$a
cat.stats(cats$Bwt[females])[3]
hist(cats$Bwt[females])
curve(dgamma(x,shape=cat.stats(cats$Bwt[females])[3],scale=cat.stats(cats$Bwt[females])[4]),add=TRUE)
hist(cats$Bwt[females],main='Female Cats Body Weight',xlab='Body Weight')
curve(dgamma(x,shape=cat.stats(cats$Bwt[females])[3],scale=cat.stats(cats$Bwt[females])[4]),add=TRUE)
hist(cats$Hwt[females],main='Female Cats Heart Weight',xlab='Heart Weight')
curve(dgamma(x,shape=cat.stats(cats$Hwt[females])[3],scale=cat.stats(cats$Hwt[females])[4]),add=TRUE)
hist(cats$Bwt[males],main='Male Cats Body Weight',xlab='Body Weight')
curve(dgamma(x,shape=cat.stats(cats$Bwt[males])[3],scale=cat.stats(cats$Bwt[males])[4]),add=TRUE)
hist(cats$Hwt[males],main='Male Cats Heart Weight',xlab='Heart Weight')
curve(dgamma(x,shape=cat.stats(cats$Hwt[males])[3],scale=cat.stats(cats$Hwt[males])[4]),add=TRUE)
hist(cats$Hwt[males],main='Male Cats Heart Weight',xlab='Heart Weight')
curve(dgamma(x,shape=cat.stats(cats$Hwt[males])[3],scale=cat.stats(cats$Hwt[males])[4]),add=TRUE)
hist(cats$Hwt, col="purple",probability=TRUE)
abline(v=mean(cats$Hwt))
hist(cats$Bwt, col="blue",probability=TRUE,add=T)
abline(v=mean(cats$Bwt))
hist(cats$Hwt, col="purple",probability=TRUE)
abline(v=mean(cats$Hwt))
hist(cats$Bwt, col="blue",probability=TRUE,add=TRUE)
abline(v=mean(cats$Bwt))
hist(cats$Hwt[females],main='Female Cats Heart Weight',xlab='Heart Weight')
library(MASS)
data(cats)
summary(cats)
cat.stats <- function(vec)
{
m<-sum(vec)/length(vec)
var <- sum(((vec-m)^2))/(length(vec)-1)
a<-(m^2)/var
s<-var/m
return(c("Mean"=m,"Variance"=var,"a"=a,"s"=s))
}
males<-which(cats$Sex=="M")
males
View(cats)
cat("The heart weight paramters for male cats are:", cat.stats(cats$Hwt[males]))
- Extracting data from unstructured sources is possible
data <- read.csv("huh.txt")
data <- read.csv("huh.rtf")
data <- read.csv("huh.txt")
data <- read.csv("wtid-report.txt")
data <- read.csv("huh.txt")
data <- read.csv("wtid-report.txt")
ls
data <- read.csv("wtid-report.csv")
data <- read.csv("wtid-report.csv")
data <- read.csv('wtid-report.csv')
data <- read.csv("wtid-report.csv")
data <- read.csv("wtid-report")
data <- read.csv("wtid-report.csv")
data
pwd
ls()
data<- read.csv("wtid-report.csv", header=TRUE, sep=",")
data<- read.csv(file="wtid-report.csv", header=TRUE, sep=",")
data<- read.csv(file="wtid-report.csv", header=TRUE, sep=",")
data
data<- read.csv(file="wtid-report.csv", header=TRUE, sep=",")
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data
View(data)
View(data)
year <- data.frame(data$year,data$P99.income.threshold, data$P99.5.income.threshold)
year <- data.frame(c(data$year,data$P99.income.threshold, data$P99.5.income.threshold))
View(year)
year <- data.frame(data$year,data$P99.income.threshold, data$P99.5.income.threshold, data$P99.9.income.threshold)
year <- data$year
P99 <- data$P99.income.threshold
P995 <-data$P99.5.income.threshold
year <- data.frame(year,P99,P995)
year <- data.frame[year,P99,P995]
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
year <- data.frame(year,P99,P99.5,P99.9)
income <- data.frame(year,P99,P99.5,P99.9)
year <- data$year
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
```
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
View(income)
income.year[which(income.year==1972)]
income.year[which(income.year=="1972")]
income$year
income$year[which(income$year=="1972")]
income$year[which(income$year==1972)]
1972yr<-which(income$year==1972)
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1972<-which(income$year==1972)
income$P99[yr1972]
income$P99.5[yr1972]
income$P99.5[yr1972]
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1942<-which(income$year==1942)
income$P99.5[yr1942]
yr1922<-which(income$year==1922)
income$P99.5[yr1922]
plot(P99,year)
plot(year,P99.5,add=T,color='r')
plot(year,P99)
plot(year,P99.5,add=T,color='r')
plot(year,P99.9,add=T)
plot(year,P99)
plot(year,P99.5)
plot(year,P99.9)
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
}
exponent.es_ratio(1e6,1e7)
exponent.est_ratio(1e6,1e7)
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
return (a)
}
exponent.est_ratio(1e6,1e7)
estimate <- exponent.est_ration(P99,P99.9)
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
View(income)
plot(year, estimate)
income <-income$year[!"a"]
is.numeric(income$year)
if (income[is.numeric(income$year)])
th
data <- data(1:100,)
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data <- data(1:100,)
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data(1:100,)
data[1:100,]
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data <- data[1:100,]
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
View(data)
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1942<-which(income$year==1942)
income$P99.5[yr1942]
yr1922<-which(income$year==1922)
income$P99.5[yr1922]
```
2.
```{r}
plot(year,P99)
plot(year,P99.5)
plot(year,P99.9)
```
3.
```{r}
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
return (a)
}
exponent.est_ratio(1e6,1e7)
```
Part II
4.
```{r}
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
plot(year, estimate)
```
Yes the results look reasonable. They tend to suggest that the income the income inequality was smalles in the years 1955 to 1983 and after that startedto
5.
```{r}
```
6.
```{r}
exponent.est_ratio <-function(p1, p2,a){
l=(p1/p2)^(-a+1)
return (l)
}
```
func(income$P99.5,income$P99.9,income$estimate)
prop<- propeople(income$P99.5,income$P99.9,income$estimate)
propeople <-function(p1, p2,a){
l=(p1/p2)^(-a+1)
return (l)
}
prop<- propeople(income$P99.5,income$P99.9,income$estimate)
income <- cbind(income,prop)
plot(year, income$prop)
abline(h=5,add=T)
abline(h=5)
plot(year, income$prop)
abline(h=5)
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data <- data[1:100,]
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1942<-which(income$year==1942)
income$P99.5[yr1942]
yr1922<-which(income$year==1922)
income$P99.5[yr1922]
plot(year,P99)
plot(year,P99.5)
plot(year,P99.9)
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
return (a)
}
exponent.est_ratio(1e6,1e7)
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
plot(year, estimate)
View(income)
income$estimate[which(income$year==2012)]
prob <-function(w,xmin,a){
calc <- (w/xmin)^(-a+1)
}
prob(0.1,50,income$estimate[which(income$year==2012)])
```
prob <-function(w,xmin,a){
calc <- (w/xmin)^(-a+1)
}
prob(0.1,50,income$estimate[which(income$year==2012)])
prob(0.1,50,income$estimate[which(income$year==2012)])
prob <-function(w,xmin,a){
calc <- (w/xmin)^(-a+1)
return(calc)
}
prob(0.1,50,income$estimate[which(income$year==2012)])
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
plot(year, estimate)
```{r,eval=FALSE}
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr
/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
prob(incom$estimate[which(income&year==2012),50,0.01])
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data <- data[1:100,]
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1942<-which(income$year==1942)
income$P99.5[yr1942]
yr1922<-which(income$year==1922)
income$P99.5[yr1922]
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return c(xmin)
}
prob(incom$estimate[which(income&year==2012),50,0.01])
plot(year,P99,main='Plot of the 99th percentile of Income',
xlab='year')
plot(year,P99.5,main='Plot of the 99th percentile of Income',
xlab='year')
plot(year,P99.9,main='Plot of the 99th percentile of Income',
xlab='year')
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
return (a)
}
exponent.est_ratio(1e6,1e7)
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
plot(year, estimate, main='Income inequality over time',
xlab='year',ylab='a')
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return c(xmin)
}
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(incom$estimate[which(income&year==2012),50,0.01])
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(incom$estimate[which(income&year==2012)],50,0.01)
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(income$estimate[which(income&year==2012)],50,0.01)
income$estimate[which(income&year==2012)]
which(income&year=2012)
people <-160681*1000
householdprop <-people*0.1
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(income$estimate[which(income$year==2012)],50,householdprop)
people <-160681*1000
householdprop <-people*0.1
people <-160681*1000
householdprop
prob(income$estimate[which(income$year==2012)],50,householdprop/people)
people <-160681*1000
people1 <-people*0.1
peopleprop <- people1/people
people <-160681*1000
people1 <-people*0.1
peopleprop <- people1/people
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(income$estimate[which(income$year==2012)],50,peopleprop)
View(income)
View(income)
prob <- function(p1,a){
xmin<- p1/((0.01)^(1/-a+1))
return (xmin)
}
prob(income$P99[which(income$year==2012)],income$estimate[which(income$year==2012)])
(50000000/xmin)^(-a+1)
xmin<-prob(income$P99[which(income$year==2012)],a)
(50000000/xmin)^(-a+1)
# method of moments
prob <- function(p1,a){
xmin<- p1/((0.01)^(1/-a+1))
return (xmin)
}
a<-income$estimate[which(income$year==2012)]
xmin<-prob(income$P99[which(income$year==2012)],a)
(50000000/xmin)^(-a+1)
proppeeps<-(50000000/xmin)^(-a+1)
households<-160681*proppeeps
households
proppeeps<-(500000000/xmin)^(-a+1)
households<-160681*proppeeps
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 7")
debt<-read.csv("debt.csv")
avgGDP<-tapply(debt$growth,debt$Country,mean)
avgGDP<- as.table(avgGDP)
avgGDPyr<-tapply(debt$growth,debt$Year,mean)
avgGDPyr.new<-as.vector(avgGDPyr)
plot(as.numeric(rownames(avgGDPyr)),avgGDPyr,ylab="Average GDP per year", xlab="Year")
cor(debt$growth,debt$ratio)
country<-split(debt,debt$Country)
names(country)
index_cor<-function(data){
x<-data$growth
y<-data$ratio
correlation.xy<-cor(x,y)
return(correlation.xy)
}
correlation.country<- sapply(country,index_cor)
mean(correlation.country)
hist(correlation.country)
par(cex=0.5)
plot(correlation.country)
axis(1,at=1:20,labels=names(correlation.country))
hist(correlation.country)
year<-split(debt,debt$Year)
names(year)
correlation.year<- sapply(year,index_cor)
mean(correlation.year)
par(cex=0.5)
plot(correlation.year)
axis(1,at=1:64,labels=names(correlation.year))
par(cex=0.3)
plot(correlation.year)
axis(1,at=1:64,labels=names(correlation.year))
plot(debt$ratio,debt$growth, main="GDP Growth vs. Debt-GDP Ratio", xlab="Debt Ratio",ylab="GDP Growth")
install.packages("Rcpp")
