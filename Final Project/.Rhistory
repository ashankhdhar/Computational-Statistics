data <- read.csv("wtid-report")
data <- read.csv("wtid-report.csv")
data
pwd
ls()
data<- read.csv("wtid-report.csv", header=TRUE, sep=",")
data<- read.csv(file="wtid-report.csv", header=TRUE, sep=",")
data<- read.csv(file="wtid-report.csv", header=TRUE, sep=",")
data
data<- read.csv(file="wtid-report.csv", header=TRUE, sep=",")
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data
View(data)
View(data)
year <- data.frame(data$year,data$P99.income.threshold, data$P99.5.income.threshold)
year <- data.frame(c(data$year,data$P99.income.threshold, data$P99.5.income.threshold))
View(year)
year <- data.frame(data$year,data$P99.income.threshold, data$P99.5.income.threshold, data$P99.9.income.threshold)
year <- data$year
P99 <- data$P99.income.threshold
P995 <-data$P99.5.income.threshold
year <- data.frame(year,P99,P995)
year <- data.frame[year,P99,P995]
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
year <- data.frame(year,P99,P99.5,P99.9)
income <- data.frame(year,P99,P99.5,P99.9)
year <- data$year
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
```
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
View(income)
income.year[which(income.year==1972)]
income.year[which(income.year=="1972")]
income$year
income$year[which(income$year=="1972")]
income$year[which(income$year==1972)]
1972yr<-which(income$year==1972)
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1972<-which(income$year==1972)
income$P99[yr1972]
income$P99.5[yr1972]
income$P99.5[yr1972]
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1942<-which(income$year==1942)
income$P99.5[yr1942]
yr1922<-which(income$year==1922)
income$P99.5[yr1922]
plot(P99,year)
plot(year,P99.5,add=T,color='r')
plot(year,P99)
plot(year,P99.5,add=T,color='r')
plot(year,P99.9,add=T)
plot(year,P99)
plot(year,P99.5)
plot(year,P99.9)
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
}
exponent.es_ratio(1e6,1e7)
exponent.est_ratio(1e6,1e7)
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
return (a)
}
exponent.est_ratio(1e6,1e7)
estimate <- exponent.est_ration(P99,P99.9)
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
View(income)
plot(year, estimate)
income <-income$year[!"a"]
is.numeric(income$year)
if (income[is.numeric(income$year)])
th
data <- data(1:100,)
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data <- data(1:100,)
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data(1:100,)
data[1:100,]
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data <- data[1:100,]
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
View(data)
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1942<-which(income$year==1942)
income$P99.5[yr1942]
yr1922<-which(income$year==1922)
income$P99.5[yr1922]
```
2.
```{r}
plot(year,P99)
plot(year,P99.5)
plot(year,P99.9)
```
3.
```{r}
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
return (a)
}
exponent.est_ratio(1e6,1e7)
```
Part II
4.
```{r}
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
plot(year, estimate)
```
Yes the results look reasonable. They tend to suggest that the income the income inequality was smalles in the years 1955 to 1983 and after that startedto
5.
```{r}
```
6.
```{r}
exponent.est_ratio <-function(p1, p2,a){
l=(p1/p2)^(-a+1)
return (l)
}
```
func(income$P99.5,income$P99.9,income$estimate)
prop<- propeople(income$P99.5,income$P99.9,income$estimate)
propeople <-function(p1, p2,a){
l=(p1/p2)^(-a+1)
return (l)
}
prop<- propeople(income$P99.5,income$P99.9,income$estimate)
income <- cbind(income,prop)
plot(year, income$prop)
abline(h=5,add=T)
abline(h=5)
plot(year, income$prop)
abline(h=5)
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data <- data[1:100,]
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1942<-which(income$year==1942)
income$P99.5[yr1942]
yr1922<-which(income$year==1922)
income$P99.5[yr1922]
plot(year,P99)
plot(year,P99.5)
plot(year,P99.9)
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
return (a)
}
exponent.est_ratio(1e6,1e7)
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
plot(year, estimate)
View(income)
income$estimate[which(income$year==2012)]
prob <-function(w,xmin,a){
calc <- (w/xmin)^(-a+1)
}
prob(0.1,50,income$estimate[which(income$year==2012)])
```
prob <-function(w,xmin,a){
calc <- (w/xmin)^(-a+1)
}
prob(0.1,50,income$estimate[which(income$year==2012)])
prob(0.1,50,income$estimate[which(income$year==2012)])
prob <-function(w,xmin,a){
calc <- (w/xmin)^(-a+1)
return(calc)
}
prob(0.1,50,income$estimate[which(income$year==2012)])
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
plot(year, estimate)
```{r,eval=FALSE}
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr
/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
prob(incom$estimate[which(income&year==2012),50,0.01])
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data <- data[1:100,]
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1942<-which(income$year==1942)
income$P99.5[yr1942]
yr1922<-which(income$year==1922)
income$P99.5[yr1922]
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return c(xmin)
}
prob(incom$estimate[which(income&year==2012),50,0.01])
plot(year,P99,main='Plot of the 99th percentile of Income',
xlab='year')
plot(year,P99.5,main='Plot of the 99th percentile of Income',
xlab='year')
plot(year,P99.9,main='Plot of the 99th percentile of Income',
xlab='year')
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
return (a)
}
exponent.est_ratio(1e6,1e7)
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
plot(year, estimate, main='Income inequality over time',
xlab='year',ylab='a')
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return c(xmin)
}
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(incom$estimate[which(income&year==2012),50,0.01])
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(incom$estimate[which(income&year==2012)],50,0.01)
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(income$estimate[which(income&year==2012)],50,0.01)
income$estimate[which(income&year==2012)]
which(income&year=2012)
people <-160681*1000
householdprop <-people*0.1
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(income$estimate[which(income$year==2012)],50,householdprop)
people <-160681*1000
householdprop <-people*0.1
people <-160681*1000
householdprop
prob(income$estimate[which(income$year==2012)],50,householdprop/people)
people <-160681*1000
people1 <-people*0.1
peopleprop <- people1/people
people <-160681*1000
people1 <-people*0.1
peopleprop <- people1/people
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(income$estimate[which(income$year==2012)],50,peopleprop)
View(income)
View(income)
prob <- function(p1,a){
xmin<- p1/((0.01)^(1/-a+1))
return (xmin)
}
prob(income$P99[which(income$year==2012)],income$estimate[which(income$year==2012)])
(50000000/xmin)^(-a+1)
xmin<-prob(income$P99[which(income$year==2012)],a)
(50000000/xmin)^(-a+1)
# method of moments
prob <- function(p1,a){
xmin<- p1/((0.01)^(1/-a+1))
return (xmin)
}
a<-income$estimate[which(income$year==2012)]
xmin<-prob(income$P99[which(income$year==2012)],a)
(50000000/xmin)^(-a+1)
proppeeps<-(50000000/xmin)^(-a+1)
households<-160681*proppeeps
households
proppeeps<-(500000000/xmin)^(-a+1)
households<-160681*proppeeps
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8")
data <- read.csv("bnames.csv")
setwd('/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8')
pwd
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8"")
)
)
]
hh
dsjah)
install.packages("numDeriv")
install.packages("numDeriv")
nabla <- function(f,...) {
require("numDeriv")
# computes the gradient at x
# g returns something because the last line is an evaluation
g <- function(x,...) { grad(func=f,x=x,...) }
return(g)
}
func<-nabla(x^2)
func(2)
body(func)
h <- function(x){ x^2}
func<-nabla(h)
func(2)
func<-nabla(function(x){ x^2})
func(2)
n <- 100
a <- 2
b <- 2
sig <- .02
x <- seq(from=0,to=1,length=n)
y <- a+b*x+rnorm(n,sd=sig)
y[4:6] <- y[4:6]+5
library(numDeriv)
data <- data.frame(x=x,y=y)
lm.fit <- lm(y~x)
par(cex=2)
plot(x,y,main="red line is l.s. fit",type="n")
points(x,y,pch=16,cex=.5)
abline(lm.fit,col="red",lwd=2)
library(numDeriv)
par(cex=0.5)
data <- data.frame(x=x,y=y)
lm.fit <- lm(y~x)
par(cex=2)
plot(x,y,main="red line is l.s. fit",type="n")
points(x,y,pch=16,cex=.5)
abline(lm.fit,col="red",lwd=2)
library(numDeriv)
par(cex=0.2)
data <- data.frame(x=x,y=y)
lm.fit <- lm(y~x)
par(cex=2)
plot(x,y,main="red line is l.s. fit",type="n")
points(x,y,pch=16,cex=.5)
abline(lm.fit,col="red",lwd=2)
par(cex=0.2)
data <- data.frame(x=x,y=y)
lm.fit <- lm(y~x)
par(cex=2)
plot(x,y,main="red line is l.s. fit",type="n")
library(numDeriv)
data <- data.frame(x=x,y=y)
lm.fit <- lm(y~x)
par(cex=0.5)
plot(x,y,main="red line is l.s. fit",type="n")
points(x,y,pch=16,cex=.5)
abline(lm.fit,col="red",lwd=2)
# build a likelihood that uses t errors
t.lhood <- function(params,x.y.data,df=4)
{
x <- x.y.data$x
y <- x.y.data$y
a <- params[1] # intercept
b <- params[2] # slope
sig <- exp(params[3]) # params[3]=log(sd) so e^(params[3])
mean.func <- a + b*x
e <- (y-mean.func)/sig
# we want the negative log likelihood
neg.log.l.hood <- -(-n*log(sig) +
sum(dt(e,df=df,log=T)))
return(neg.log.l.hood)
}
# build a gradient function
t.grad.neg.log.l <- function(params,x.y.data,df=4)
{
grad.t <- grad(t.lhood,x=params,x.y.data=x.y.data,df=df)
return(grad.t)
}
start <- c(1,1,0) # random values a,b,log(sigma)
est <- optim(start,t.lhood,t.grad.neg.log.l,method="BFGS",x.y.data=data,hessian=T)
start <- c(1,1,0) # random values a,b,log(sigma)
est <- optim(start,t.lhood,t.grad.neg.log.l,method="BFGS",x.y.data=data,hessian=T)
lm.fit <- lm(y~x)
par(cex=2)
plot(x,y,main="red line is l.s. fit, green is t(df=4)",type="n")
points(x,y,pch=16,cex=.5)
abline(lm.fit,col="red",lwd=2)
abline(est$par[1:2],col="green",lwd=2)
MC.N <- 1000
keep.est <- data.frame(a.hat=rep(NA,MC.N),b.hat=rep(NA,MC.N),log.s.hat=rep(NA,MC.N))
keep.se <- data.frame(se.a.hat=rep(NA,MC.N),se.b.hat=rep(NA,MC.N),se.log.s.hat=rep(NA,MC.N))
for (mc.i in 1:1000)
{
y <- a+b*x+rnorm(n,sd=sig)
y[4:6] <- y[4:6]+5
data <- data.frame(x=x,y=y)
est <- optim(start,t.lhood,t.grad.neg.log.l,method="BFGS",x.y.data=data,hessian=T)
keep.est[mc.i,] <- est$par
keep.se[mc.i,] <- sqrt(diag(solve(est$hessian)))	# gives you the standard error
}
quartz()
par(mfrow=c(2,3),cex.lab=2)
hist(keep.est[,1],xlab="Estimated a",main="",xlim=range(c(keep.est[,1],a)))
abline(v=a,col="red",lwd=3)
hist(keep.est[,2],xlab="Estimated b",main="",xlim=range(c(keep.est[,2],b)))
abline(v=b,col="red",lwd=3)
hist(keep.est[,3],xlab="Estimated log sig",main="",xlim=range(c(keep.est[,3],log(sig))))
abline(v=log(sig),col="red",lwd=3)
hist(keep.se[,1],xlab="Estimated se a",main="",xlim=range(c(keep.se[,1],sd(keep.est[,1]))))
abline(v=sd(keep.est[,1]),col="red",lwd=3)
hist(keep.se[,2],xlab="Estimated se b",main="",xlim=range(c(keep.se[,2],sd(keep.est[,2]))))
abline(v=sd(keep.est[,2]),col="red",lwd=3)
hist(keep.se[,3],xlab="Estimated se log sig",main="",xlim=range(c(keep.se[,3],sd(keep.est[,3]))))
abline(v=sd(keep.est[,3]),col="red",lwd=3)
rest.list <- function(city,state){
address <- paste("http://www.yelp.com/",city-state-us,sep="")
return(address)
}
rest.list(amherst,ma)
rest.list <- function(city,state){
address <- cat("http://www.yelp.com/",city,"-",state,"-us",sep="")
return(address)
}
rest.list(amherst,ma)
address <- cat("http://www.yelp.com/",m,"-",p,"-us",sep="")
m="t"
p="s"
address <- cat("http://www.yelp.com/",m,"-",p,"-us",sep="")
rest.list <- function(city,state){
address <- cat("http://www.yelp.com/",tolower(city),"-",tolower(state),"-us")
return(address)
}
rest.list(amherst,state)
rest.list(city,state)
rest.list("city","state")
rest.list <- function(city,state){
address <- cat("http://www.yelp.com/",tolower(city),"-",tolower(state),"-us",sep="")
return(address)
}
rest.list("city","state")
rest.list <- function(city,state){
address <- cat("http://www.yelp.com/",tolower(city),"-",tolower(state),"-","us",sep="")
return(address)
}
rest.list("city","state")
rest.list <- function(city,state){
address <- cat("http://www.yelp.com/",tolower(city),"-",tolower(state),"-","us",sep="")
main.pg<-readLines(address)
}
rest.list <- function(city,state){
address <- cat("http://www.yelp.com/",tolower(city),"-",tolower(state),"-","us",sep="")
main.pg<-readLines(address)
return(main.pg)
}
rest.list("amherst","ma")
readLines("http://www.yelp.com/amherst-ma-us")
rest.list <- function(city,state){
address <- cat("http://www.yelp.com/",tolower(city),"-",tolower(state),"-","us",sep="")
main.pg<-readLines(address)
return(main.pg)
}
rest.list("amherst","ma")
rest.list <- function(city,state){
address <- cat("http://www.yelp.com/",tolower(city),"-",tolower(state),"-","us",sep="")
main.pg<-readLines(address)
return(main.pg)
}
rest.list("amherst","ma")
library(knitr)
opts_chunk$set(tidy.opts=list(width.cutoff=60))
rest.list <- function(city,state){
address <- cat("http://www.yelp.com/",tolower(city),"-",tolower(state),"-","us",sep="")
main.pg<-readLines(address)
return(main.pg)
}
rest.list("amherst","ma")
rest.list <- function(city,state){
address <-paste("http://www.yelp.com/",tolower(city),"-",tolower(state),"-","us",sep="")
main.pg<-readLines(address)
return(main.pg)
}
rest.list("amherst","ma")
library(knitr)
opts_chunk$set(tidy.opts=list(width.cutoff=60))
library(knitr)
opts_chunk$set(tidy.opts=list(width.cutoff=60))
rest.list <- function(city,state){
address <-paste("http://www.yelp.com/",tolower(city),"-",tolower(state),"-","us",sep="")
main.pg<-readLines(address)
return(main.pg)
}
View(rest.list("amherst","ma"))
package.skeleton("Example")
pwd()
getwd
g<-getwd()
g
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Final Project")
package.skeleton("Example")
