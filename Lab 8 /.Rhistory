year <- data$year
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
```
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
View(income)
income.year[which(income.year==1972)]
income.year[which(income.year=="1972")]
income$year
income$year[which(income$year=="1972")]
income$year[which(income$year==1972)]
1972yr<-which(income$year==1972)
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1972<-which(income$year==1972)
income$P99[yr1972]
income$P99.5[yr1972]
income$P99.5[yr1972]
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1942<-which(income$year==1942)
income$P99.5[yr1942]
yr1922<-which(income$year==1922)
income$P99.5[yr1922]
plot(P99,year)
plot(year,P99.5,add=T,color='r')
plot(year,P99)
plot(year,P99.5,add=T,color='r')
plot(year,P99.9,add=T)
plot(year,P99)
plot(year,P99.5)
plot(year,P99.9)
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
}
exponent.es_ratio(1e6,1e7)
exponent.est_ratio(1e6,1e7)
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
return (a)
}
exponent.est_ratio(1e6,1e7)
estimate <- exponent.est_ration(P99,P99.9)
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
View(income)
plot(year, estimate)
income <-income$year[!"a"]
is.numeric(income$year)
if (income[is.numeric(income$year)])
th
data <- data(1:100,)
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data <- data(1:100,)
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data(1:100,)
data[1:100,]
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data <- data[1:100,]
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
View(data)
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1942<-which(income$year==1942)
income$P99.5[yr1942]
yr1922<-which(income$year==1922)
income$P99.5[yr1922]
```
2.
```{r}
plot(year,P99)
plot(year,P99.5)
plot(year,P99.9)
```
3.
```{r}
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
return (a)
}
exponent.est_ratio(1e6,1e7)
```
Part II
4.
```{r}
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
plot(year, estimate)
```
Yes the results look reasonable. They tend to suggest that the income the income inequality was smalles in the years 1955 to 1983 and after that startedto
5.
```{r}
```
6.
```{r}
exponent.est_ratio <-function(p1, p2,a){
l=(p1/p2)^(-a+1)
return (l)
}
```
func(income$P99.5,income$P99.9,income$estimate)
prop<- propeople(income$P99.5,income$P99.9,income$estimate)
propeople <-function(p1, p2,a){
l=(p1/p2)^(-a+1)
return (l)
}
prop<- propeople(income$P99.5,income$P99.9,income$estimate)
income <- cbind(income,prop)
plot(year, income$prop)
abline(h=5,add=T)
abline(h=5)
plot(year, income$prop)
abline(h=5)
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data <- data[1:100,]
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1942<-which(income$year==1942)
income$P99.5[yr1942]
yr1922<-which(income$year==1922)
income$P99.5[yr1922]
plot(year,P99)
plot(year,P99.5)
plot(year,P99.9)
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
return (a)
}
exponent.est_ratio(1e6,1e7)
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
plot(year, estimate)
View(income)
income$estimate[which(income$year==2012)]
prob <-function(w,xmin,a){
calc <- (w/xmin)^(-a+1)
}
prob(0.1,50,income$estimate[which(income$year==2012)])
```
prob <-function(w,xmin,a){
calc <- (w/xmin)^(-a+1)
}
prob(0.1,50,income$estimate[which(income$year==2012)])
prob(0.1,50,income$estimate[which(income$year==2012)])
prob <-function(w,xmin,a){
calc <- (w/xmin)^(-a+1)
return(calc)
}
prob(0.1,50,income$estimate[which(income$year==2012)])
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
plot(year, estimate)
```{r,eval=FALSE}
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr
/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
prob(incom$estimate[which(income&year==2012),50,0.01])
data<- read.csv(file="/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 5/wtid-report.csv", header=TRUE, sep=",")
data <- data[1:100,]
year <- data$Year
P99 <- data$P99.income.threshold
P99.5 <-data$P99.5.income.threshold
P99.9 <- data$P99.9.income.threshold
income <- data.frame(year,P99,P99.5,P99.9)
yr1972<-which(income$year==1972)
income$P99[yr1972]
yr1942<-which(income$year==1942)
income$P99.5[yr1942]
yr1922<-which(income$year==1922)
income$P99.5[yr1922]
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return c(xmin)
}
prob(incom$estimate[which(income&year==2012),50,0.01])
plot(year,P99,main='Plot of the 99th percentile of Income',
xlab='year')
plot(year,P99.5,main='Plot of the 99th percentile of Income',
xlab='year')
plot(year,P99.9,main='Plot of the 99th percentile of Income',
xlab='year')
exponent.est_ratio <-function(p1, p2){
a=1-(log(10)/log(p1/p2))
return (a)
}
exponent.est_ratio(1e6,1e7)
estimate <- exponent.est_ratio(P99,P99.9)
income <- cbind(income,estimate)
plot(year, estimate, main='Income inequality over time',
xlab='year',ylab='a')
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return c(xmin)
}
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(incom$estimate[which(income&year==2012),50,0.01])
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(incom$estimate[which(income&year==2012)],50,0.01)
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(income$estimate[which(income&year==2012)],50,0.01)
income$estimate[which(income&year==2012)]
which(income&year=2012)
people <-160681*1000
householdprop <-people*0.1
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(income$estimate[which(income$year==2012)],50,householdprop)
people <-160681*1000
householdprop <-people*0.1
people <-160681*1000
householdprop
prob(income$estimate[which(income$year==2012)],50,householdprop/people)
people <-160681*1000
people1 <-people*0.1
peopleprop <- people1/people
people <-160681*1000
people1 <-people*0.1
peopleprop <- people1/people
prob <-function(a,w,p1){
xmin <- (w*1000000)/(((p1)^(1/(-a+1))))
return (xmin)
}
prob(income$estimate[which(income$year==2012)],50,peopleprop)
View(income)
View(income)
prob <- function(p1,a){
xmin<- p1/((0.01)^(1/-a+1))
return (xmin)
}
prob(income$P99[which(income$year==2012)],income$estimate[which(income$year==2012)])
(50000000/xmin)^(-a+1)
xmin<-prob(income$P99[which(income$year==2012)],a)
(50000000/xmin)^(-a+1)
# method of moments
prob <- function(p1,a){
xmin<- p1/((0.01)^(1/-a+1))
return (xmin)
}
a<-income$estimate[which(income$year==2012)]
xmin<-prob(income$P99[which(income$year==2012)],a)
(50000000/xmin)^(-a+1)
proppeeps<-(50000000/xmin)^(-a+1)
households<-160681*proppeeps
households
proppeeps<-(500000000/xmin)^(-a+1)
households<-160681*proppeeps
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8")
data <- read.csv("bnames.csv")
setwd('/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8')
pwd
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8"")
)
)
]
hh
dsjah)
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8")
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8")
data <- read.csv("bnames.csv")
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8")
data <- read.csv("bnames.csv")
data <- read.csv("bnames.csv")
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8")
data <- read.csv("bnames.csv")
pwd()
data <- read.csv("bnames.csv")
data <- read.csv("bnames.csv")
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8")
data <- read.csv("bnames.csv")
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8 ")
data <- read.csv("bnames.csv")
View(data)
View(data)
dataf <- data.fram(name=data$name,percent=data$percent)
dataf <- data.frame(name=data$name,percent=data$percent)
View(dataf)
name.perc <- ddply(data,.(name),summarize,sum.perc=sum(percent))
library(plyr)
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8 ")
data <- read.csv("bnames.csv")
name.perc <- ddply(data,.(name),summarize,sum.perc=sum(percent))
View(name.perc)
name.perc <- ddply(data,.(name,sex),summarize,sum.perc=sum(percent))
name.perc <- ddply(data,.(name),summarize,sum.perc=sum(percent))
name_sex.perc <- ddply(data,.(name,sex),summarize,sum.perc=sum(percent))
View(name_sex.perc)
name_boy.perc <- ddply(data,.(name,sex=boy),summarize,sum.perc=sum(percent))
name_boy.perc <- ddply(data,.(name,sex="boy"),summarize,sum.perc=sum(percent))
View(name_boy.perc)
subset.boy <- subset(data, sex=="boy")
name_boy.perc <- ddply(subset.boy,.(name,sex),summarize,sum.perc=sum(percent))
View(name_boy.perc)
library(plyr)
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8 ")
data <- read.csv("bnames.csv")
name.perc <- ddply(data,.(name),summarize,sum.perc=sum(percent))
subset.boy <- subset(data, sex=="boy")
subset.girl <-subset(data, sex=="girl")
name_boy.perc <- ddply(subset.boy,.(name,sex),summarize,sum.perc=sum(percent))
name_girl.perc <- ddply(subset.girl,.(name,sex),summarize,sum.perc=sum(percent))
View(name_girl.perc)
name_boy.perc[1:10,:]
name_boy.perc[1:10,]
name_girl.perc[1:10,]
name_boy.perc <- ddply(subset.boy,.(name),summarize,sum.perc=sum(percent))
name_girl.perc <- ddply(subset.girl,.(name),summarize,sum.perc=sum(percent))
name_boy.perc[1:10,]
name_girl.perc[1:10,]
View(data)
years<-ddply(subset.boy,.(year),summarize,sum.perc=sum(percent))
years<-ddply(data,.(year),summarize,sum.perc=sum(percent))
View(years)
years<-c(data$year)
View(name_girl.perc)
data[order(x),]
data[order(percent),]
data[order(data$percent),]
data.sorted<-data[order(data$percent),]
View(data.sorted)
data.sorted<-data[order(-data$percent),]
View(data.sorted)
year<- subset(data, year="1880", sex="boy")
View(year)
year1880.boy<- subset(data, year="1880", sex="boy")
library(plyr)
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8 ")
data <- read.csv("bnames.csv")
name.perc <- ddply(data,.(name),summarize,sum.perc=sum(percent))
subset.boy <- subset(data, sex=="boy")
subset.girl <-subset(data, sex=="girl")
name_boy.perc <- ddply(subset.boy,.(name),summarize,sum.perc=sum(percent))
name_girl.perc <- ddply(subset.girl,.(name),summarize,sum.perc=sum(percent))
name_boy.perc[1:10,]
name_girl.perc[1:10,]
subset.girl <-subset(data, sex=="girl")
yearnew<- year1880.boy[order(-percent),]
year1880.boy<- subset(data, year="1880", sex="boy")
yearnew<- year1880.boy[order(-percent),]
View(year1880.boy)
yearnew<- year1880.boy[order(- year1880.boy$percent),]
View(yearnew)
yearnew[1:5]
top5<- yearnew[1:5,]
top5
top5<- t(yearnew$name[1:5,])
top5<-yearnew$name[1:5,]
top5<-yearnew$name[1:5]
top5<-t(yearnew$name[1:5])
top5
View(year1880.boy)
tail(year1880.boy)
year1880.boy<- subset(data, (year=="1880")& (sex=="boy"))
yearnew<- year1880.boy[order(- year1880.boy$percent),]
top5<-t(yearnew$name[1:5])
top5
popular.names <- function(data,year){
year.boy<- subset(data, (year==year)& (sex=="boy"))
year.girl<- subset(data, (year==year)& (sex=="girl"))
yearnew.boy<- year.boy[order(- year.boy$percent),]
yearnew.girl<- year.girl[order(- year.girl$percent),]
top5.boy<-t(yearnew.boy$name[1:5])
top5.girl<-t(yearnew.girl$name[1:5])
top5.all<-c(top5.boy,top5.gir)
return(top5.all)
}
popular.name(data,"1880")
popular.names(data,"1880")
popular.names <- function(data,year){
year.boy<- subset(data, (year==year)& (sex=="boy"))
year.girl<- subset(data, (year==year)& (sex=="girl"))
yearnew.boy<- year.boy[order(- year.boy$percent),]
yearnew.girl<- year.girl[order(- year.girl$percent),]
top5.boy<-t(yearnew.boy$name[1:5])
top5.girl<-t(yearnew.girl$name[1:5])
top5.all<-c(top5.boy,top5.girl)
return(top5.all)
}
popular.names(data,"1880")
popular.names <- function(data,year){
year.boy<- subset(data, (year==year)& (sex=="boy"))
year.girl<- subset(data, (year==year)& (sex=="girl"))
yearnew.boy<- year.boy[order(- year.boy$percent),]
yearnew.girl<- year.girl[order(- year.girl$percent),]
top5.boy<-t(yearnew.boy$name[1:5])
top5.girl<-t(yearnew.girl$name[1:5])
top5.all<-c(top5.boy;top5.girl)
return(top5.all)
}
popular.names <- function(data,year){
year.boy<- subset(data, (year==year)& (sex=="boy"))
year.girl<- subset(data, (year==year)& (sex=="girl"))
yearnew.boy<- year.boy[order(- year.boy$percent),]
yearnew.girl<- year.girl[order(- year.girl$percent),]
top5.boy<-t(yearnew.boy$name[1:5])
top5.girl<-t(yearnew.girl$name[1:5])
top5.all<-c(top5.boy,top5.girl)
return(top5.all)
}
popular.names(data,"1880")
year1880.boy<- subset(data, (year=="1880")& (sex=="boy"))
popular.test<-function(data){
yearnew<- data[order(- data$percent),]
top5<-t(yearnew$name[1:5])
return(top5)
}
popular.test(year1880.boy)
year1880.boy<- subset(data, (year=="1880")& (sex=="boy"))
popular.test<-function(data){
yearnew<- data[order(- data$percent),]
top5<-as.data.frame(t(yearnew$name[1:5]))
return(top5)
}
popular.test(year1880.boy)
year1880.boy<- subset(data, (year=="1880")& (sex=="boy"))
popular.test<-function(data){
yearnew<- data[order(- data$percent),]
top5<-t(yearnew$name[1:5])
return(top5)
}
popular.test(year1880.boy)
temp <- ddply(data,.(year,sex),popular.test)
yearnew<- data[order(- data$percent),]
top5<-t(yearnew$name[1:5])
top5
yearnew<- data[order(- data$percent),]
top5<-yearnew$name[1:5]
top5
as.data.frame(top5)
popular.test<-function(data){
yearnew<- data[order(- data$percent),]
top<-yearnew$name[1:5]
val <- data.frame(name.1=top[1],name.2=top[2],name.3=top[3],name.4=top[4],name.5=top[5])
return(val)
}
popular.test(year1880.boy)
temp <- ddply(data,.(year,sex),popular.test)
View(temp)
yearnew<- data[order(- data$percent),]
top<-yearnew$name[1:5]
top
View(top)
names(top)
name(top)
top[1]
library(plyr)
setwd("/Users/ankitashankhdhar/Documents/Grad 2nd yr/Comp Stats/Lab 8 ")
data <- read.csv("bnames.csv")
name.perc <- ddply(data,.(name),summarize,sum.perc=sum(percent))
subset.boy <- subset(data, sex=="boy")
subset.girl <-subset(data, sex=="girl")
name_boy.perc <- ddply(subset.boy,.(name),summarize,sum.perc=sum(percent))
name_girl.perc <- ddply(subset.girl,.(name),summarize,sum.perc=sum(percent))
name_boy.perc[1:10,]
name_girl.perc[1:10,]
#function takes in data and then orders by percent
popular.names<-function(data){
yearnew<- data[order(- data$percent),]
top<-yearnew$name[1:5]
#order them by name and set them in a data frame
val <- data.frame(name.1=top[1],name.2=top[2],name.3=top[3],name.4=top[4],name.5=top[5])
return(val)
}
#test for one year and one sex
year1880.boy<- subset(data, (year=="1880")& (sex=="boy"))
popular.names(year1880.boy)
#gets all the popular names every year for both genders
popular.all <- ddply(data,.(year,sex),popular.names)
head(popular.all)
tail(popular.all)
lm.fit <- function(temp){
fit <- lm(percent~year,data=temp)
return(data.frame(int=fit$coef[1],slope=fit$coef[2],
n=dim(temp)[1]))
}
inc.dec <- ddply(data,.(name,sex),lm.fit)
inc.dec
head(inc.dec)
View(data)
View(name_boy.perc)
inc.dec <- subset(inc.dec,n>100)
View(inc.dec)
inc.dec <- subset(inc.dec,(slope>quantile(slope,p=0.99,na.rm=T))|
(slope<quantile(slope,p=0.01,na.rm=T)))
View(inc.dec)
